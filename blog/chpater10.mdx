---
slug: 10-state-management
title: 10ì¥. ìƒíƒœ ê´€ë¦¬
authors: [yunkuk]
tags: [typescript, react, state]
---

> (props, state) => UI(JSX)

## 1. ìƒíƒœ ê´€ë¦¬

### 1-1. ìƒíƒœ(state)

> ë Œë“œë§ ê²°ê³¼ì— ì˜í–¥ì„ ì£¼ëŠ” ì •ë³´ë¥¼ ë‹´ì€ ìˆœìˆ˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°ì²´

### 1-2. [ìƒíƒœë¥¼ ì˜ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ê°€ì´ë“œ](https://ko.react.dev/learn/thinking-in-react)

> - ì‹œê°„ì´ ì§€ë‚˜ë„ ë³€í•˜ì§€ ì•Šë‚˜ìš”? ê·¸ëŸ¬ë©´ í™•ì‹¤íˆ stateê°€ ì•„ë‹™ë‹ˆë‹¤.
> - ë¶€ëª¨ë¡œë¶€í„° propsë¥¼ í†µí•´ ì „ë‹¬ë©ë‹ˆê¹Œ? ê·¸ëŸ¬ë©´ í™•ì‹¤íˆ stateê°€ ì•„ë‹™ë‹ˆë‹¤.
> - ì»´í¬ë„ŒíŠ¸ ì•ˆì˜ ë‹¤ë¥¸ stateë‚˜ propsë¥¼ ê°€ì§€ê³  ê³„ì‚° ê°€ëŠ¥í•œê°€ìš”? ê·¸ë ‡ë‹¤ë©´ ì ˆëŒ€ë¡œ stateê°€ ì•„ë‹™ë‹ˆë‹¤!
>
> ê·¸ ì™¸ ë‚¨ëŠ” ê±´ ì•„ë§ˆ stateì¼ ê²ë‹ˆë‹¤.
>
> ğŸ“š React ê³µì‹ë¬¸ì„œ - thinking in react

> ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” ìƒíƒœë¥¼ useEffectë¡œ ë™ê¸°í™”í•˜ë©´ ê°œë°œìê°€ ì¶”ì í•˜ê¸° ì–´ë ¤ì›Œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
> useEffectë¡œ ë™ê¸°í™” í•˜ëŠ” ê²ƒì€ í”¼í•´ì•¼ í•œë‹¤.  
> ğŸ“š 311p

### 1-3. useState vs useReducer

> useState ëŒ€ì‹  useReducer ì‚¬ìš©ì„ ê¶Œì¥í•˜ëŠ” ê²½ìš°ëŠ” í¬ê²Œ 2ê°€ì§€ê°€ ìˆë”°.

- ë‹¤ìˆ˜ì˜ í•˜ìœ„ í•„ë“œë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ë³µì¡í•œ ìƒíƒœ ë¡œì§ì„ ë‹¤ë£° ë•Œ
- ë‹¤ìŒ ìƒíƒœê°€ ì´ì „ ìƒíƒœì— ì˜ì¡´ì ì¼ ë•Œ

Advanced Searchì™€ ê°™ì´ ì¿¼ë¦¬ë¥¼ ìƒíƒœë¡œ ì €ì¥í•´ì•¼í•œë‹¤ê³  í•´ë³´ì.
ì´ëŸ° ì¿¼ë¦¬ë“¤ì€ ë‹¨ìˆœí•˜ì§€ ì•Šê³  ê²€ìƒ‰ ë‚ ì§œ ë²”ìœ„, í‚¤ì›Œë“œ, ì¹´ë“œì‚¬ ë“± ë‹¤ì–‘í•œ í•„ë“œë¥¼ í¬í•¨í•  ìˆ˜ ìˆë‹¤. í˜ì´ì§€ë„¤ì´ì…˜ì„ ê³ ë ¤í•œë‹¤ë©´ í˜ì´ì§€, ì‚¬ì´ì¦ˆ ë“±ì˜ í•„ë“œë„ ì¶”ê°€ë  ìˆ˜ ìˆë‹¤.

```tsx
type DateRangePreset = 'today' | 'yesterday' | 'thisWeek' | 'lastWeek' | 'thisMonth' | 'lastMonth';

enum CardSet = {
  VISA = 'VISA',
  MASTER = 'MASTER',
  AMEX = 'AMEX',
  JCB = 'JCB',
  UNIONPAY = 'UNIONPAY',
}

interface SearchFilter {
  keyword: string;
  dateRange: DateRangePreset;
  cardSet: CardSet[];
  // ì´ì™¸ ê¸°íƒ€ í•„í„°ë§ ì˜µì…˜
}

interface State {
  filter: SearchFilter;
  page: number;
  size: number;
}
```

> ì´ëŸ¬í•œ ë°ì´í„° êµ¬ì¡°ë¥¼ `useState`ë¡œ ë‹¤ë£¨ë©´ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œë§ˆë‹¤ ì ì¬ì ì¸ ì˜¤ë¥˜ ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤. ì´ëŸ° ë³µì¡í•œ ìƒíƒœ ë¡œì§ì„ ë‹¤ë£° ë•ŒëŠ” `useReducer`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.  
> `useReducer`ëŠ” 'ë¬´ì—‡ì„ ë³€ê²½í• ì§€'ì™€ 'ì–´ë–»ê²Œ ë³€ê²½í• ì§€'ë¥¼ ë¶„ë¦¬í•˜ì—¬ `dispatch`ë¥¼ í†µí•´ ì–´ë–¤ ì‘ì—…ì„ í• ì§€ë¥¼ ì•¡ì…˜ìœ¼ë¡œ ë„˜ê¸°ê³  `reducer` í•¨ìˆ˜ ë‚´ì—ì„œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ë°©ì‹ì„ ì •ì˜í•œë‹¤  
> ğŸ“š 314p

```tsx
// Action ì •ì˜
type Action =
  | { payload: SearchFilter; type: "filter" }
  | { payload: number; type: "navigate" }
  | { payload: number; type: "resize" };

// Reducer ì •ì˜
const reducer: React.Reducer<State, Action> = (state, action) => {
  switch (action.type) {
    case "filter":
      return { filter: action.payload, page: 0, size: state.size };
    case "navigate":
      return { ...state, page: action.payload };
    case "resize":
      return { ...state, size: action.payload };
    default:
      return state;
  }
};

// useReducer ì‚¬ìš©
const [state, dispatch] = useReducer(reducer, initialState);

// dispatch ì‚¬ìš©
dispatch({
  type: "filter",
  payload: { keyword: "react", dateRange: "today", cardSet: ["VISA"] },
});
dispatch({ type: "navigate", payload: 1 });
dispatch({ type: "resize", payload: 10 });
```

ì´ì™¸ì—ë„ boolean ìƒíƒœë¥¼ í† ê¸€í•˜ëŠ” ì•¡ì…˜ë§Œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° `useState` ëŒ€ì‹  `useReducer`ë¥¼ ì‚¬ìš©í•˜ê³¤ í•œë‹¤.

```tsx
const [fold, setFold] = useReducer((fold) => !fold, false);
```

### 1-4. Context API

> Context APIë¥¼ ì´ìš©í•˜ì—¬ ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ëŒ€ê·œëª¨ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê¶Œì¥ë˜ì§„ ì•ŠëŠ”ë‹¤.
>
> - ì»¨í…ìŠ¤íŠ¸ í”„ë¡œë°”ì´ë”ì˜ propsë¡œ ì£¼ì…ëœ ê°’ì´ë‚˜ ì°¸ì¡°ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ í•´ë‹¹ ì»¨í…ìŠ¤íŠ¸ë¥¼ êµ¬ë…í•˜ê³  ìˆëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§

ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•  ë•Œ ê´€ì‹¬ì‚¬ë¥¼ ì˜ ë¶„ë¦¬í•´ì„œ êµ¬ì„±í•˜ë©´ ë¦¬ë Œë”ë§ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆì§€ë§Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì»¤ì§€ê³  ì „ì—­ ìƒíƒœê°€ ë§ì•„ì§ˆìˆ˜ë¡ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ê³¼ ìƒíƒœì˜ ë³µì¡ë„ê°€ ì¦ê°€í•œë‹¤.

Bad Case ì˜ˆì‹œ
í•˜ë‚˜ì˜ ì»¨í…ìŠ¤íŠ¸ì— ì—¬ëŸ¬ ê´€ì‹¬ì‚¬ í¬í•¨:

```tsx
const AppStateContext = React.createContext();

function App() {
  const [user, setUser] = useState(null);
  const [theme, setTheme] = useState("light");
  const [products, setProducts] = useState([]);

  return (
    <AppStateContext.Provider
      value={{ user, setUser, theme, setTheme, products, setProducts }}
    >
      {/* Application Components */}
    </AppStateContext.Provider>
  );
}
```

ì´ ê²½ìš°, ì‚¬ìš©ì ì •ë³´, í…Œë§ˆ, ì œí’ˆ ë°ì´í„° ë“± ì„œë¡œ ë‹¤ë¥¸ ê´€ì‹¬ì‚¬ì˜ ìƒíƒœë“¤ì´ í•˜ë‚˜ì˜ ì»¨í…ìŠ¤íŠ¸ì— í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í…Œë§ˆë¥¼ ë³€ê²½í•  ë•Œ ì‚¬ìš©ì ì •ë³´ì™€ ì œí’ˆ ì •ë³´ë¥¼ í¬í•¨í•œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```tsx
const UserContext = React.createContext();
const ThemeContext = React.createContext();
const ProductContext = React.createContext();

function App() {
  const [user, setUser] = useState(null);
  const [theme, setTheme] = useState("light");
  const [products, setProducts] = useState([]);

  return (
    <UserContext.Provider value={{ user, setUser }}>
      <ThemeContext.Provider value={{ theme, setTheme }}>
        <ProductContext.Provider value={{ products, setProducts }}>
          {/* Application Components */}
        </ProductContext.Provider>
      </ThemeContext.Provider>
    </UserContext.Provider>
  );
}
```
